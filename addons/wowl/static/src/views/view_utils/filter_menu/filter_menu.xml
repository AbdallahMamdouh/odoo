<?xml version="1.0" encoding="UTF-8"?>
<templates xml:space="preserve">

    <t t-name="wowl.FilterMenu" owl="1">
        <Dropdown t-on-dropdown-item-selected.stop="onDropdownItemSelected" class="o_filter_menu" togglerClass="'btn btn-secondary'">
            <i t-if="icon" t-att-class="icon"/>
            <span class="o_dropdown_title" t-esc="title"/>
            <t t-set-slot="menu">
                <t t-set="currentGroup" t-value="null"/>
                <t t-foreach="items" t-as="item" t-key="item.id">
                    <div t-if="currentGroup !== null and currentGroup !== item.groupNumber" role="separator" class="dropdown-divider"/>
                    <t t-if="item.options">
                        <Dropdown t-att-togglerClass="{ o_dropdown_active: item.isActive }"> <!-- class does not work: dropdown takes controll, hum --> 
                            <t t-set="subGroup" t-value="null"/>
                            <t t-esc="item.description"/>
                            <t t-set-slot="menu">
                                <t t-foreach="item.options" t-as="option" t-key="option.id">
                                    <div t-if="subGroup !== null and subGroup !== item.groupNumber" role="separator" class="dropdown-divider"/>
                                    <DropdownItem payload="{ itemId: item.id, optionId: option.id }" t-att-class="{ o_dropdown_active: option.isActive }">
                                        <t t-esc="option.description"/>
                                    </DropdownItem>
                                    <t t-set="subGroup" t-value="option.groupNumber"/>
                                </t>  
                            </t> 
                        </Dropdown>
                    </t>
                    <t t-else="">             
                        <DropdownItem payload="{ itemId: item.id }" t-att-class="{ o_dropdown_active: item.isActive }">
                            <t t-esc="item.description"/>
                        </DropdownItem>
                    </t>
                    <t t-set="currentGroup" t-value="item.groupNumber"/>
                </t>
            </t>
        </Dropdown>
    </t>

</templates>